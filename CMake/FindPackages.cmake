# generated by Buildyard, do not edit.

include(System)
list(APPEND FIND_PACKAGES_DEFINES ${SYSTEM})
# Copyright (c) 2014 Stefan.Eilemann@epfl.ch

# Provides common_package(Name args) which improves find_package.
# First invokes find_package with all the given arguments, and then
# falls back to using pkg_config if available. The pkg_config path
# does only implement the version, REQUIRED and QUIET find_package
# arguments (e.g. no COMPONENTS)

find_package(PkgConfig)
set(ENV{PKG_CONFIG_PATH}
  "${CMAKE_INSTALL_PREFIX}/lib/pkgconfig:$ENV{PKG_CONFIG_PATH}")

macro(COMMON_PACKAGE Name)
  string(TOUPPER ${Name} COMMON_PACKAGE_NAME)
  set(COMMON_PACKAGE_ARGS ${ARGN}) # ARGN is not a list. make one.
  set(COMMON_PACKAGE_VERSION)

  if(COMMON_PACKAGE_ARGS)
    list(GET COMMON_PACKAGE_ARGS 0 COMMON_PACKAGE_VERSION)
    if(COMMON_PACKAGE_VERSION MATCHES "^[0-9.]+$") # is a version
      set(COMMON_PACKAGE_VERSION ">=${COMMON_PACKAGE_VERSION}")
    else()
      set(COMMON_PACKAGE_VERSION)
    endif()
  endif()

  list(FIND COMMON_PACKAGE_ARGS "QUIET" COMMON_PACKAGE_QUIET_POS)
  if(COMMON_PACKAGE_QUIET_POS EQUAL -1)
    set(COMMON_PACKAGE_QUIET)
  else()
    set(COMMON_PACKAGE_QUIET "QUIET")
  endif()

  list(FIND COMMON_PACKAGE_ARGS "REQUIRED" COMMON_PACKAGE_REQUIRED_POS)
  if(COMMON_PACKAGE_REQUIRED_POS EQUAL -1) # Optional find
    find_package(${Name} ${COMMON_PACKAGE_ARGS}) # try standard cmake way
    if((NOT ${Name}_FOUND) AND (NOT ${COMMON_PACKAGE_NAME}_FOUND) AND PKG_CONFIG_EXECUTABLE)
      pkg_check_modules(${Name} ${Name}${COMMON_PACKAGE_VERSION}
        ${COMMON_PACKAGE_QUIET}) # try pkg_config way
    endif()
  else() # required find
    list(REMOVE_AT COMMON_PACKAGE_ARGS ${COMMON_PACKAGE_REQUIRED_POS})
    find_package(${Name} ${COMMON_PACKAGE_ARGS}) # try standard cmake way
    if((NOT ${Name}_FOUND) AND (NOT ${COMMON_PACKAGE_NAME}_FOUND) AND PKG_CONFIG_EXECUTABLE)
      pkg_check_modules(${Name} REQUIRED ${Name}${COMMON_PACKAGE_VERSION}
        ${COMMON_PACKAGE_QUIET}) # try pkg_config way (and fail if needed)
    endif()
  endif()
endmacro()

common_package(BBPTestData 2.0   )
common_package(OpenMP    )
common_package(Tuvok    )
common_package(VTune    )
common_package(GLEW_MX    )
common_package(zeq    )
common_package(FlatBuffers    )
common_package(RESTBridge    )
common_package(LibJpegTurbo 1.2.1   )
common_package(Boost 1.41.0  REQUIRED COMPONENTS filesystem program_options thread system regex unit_test_framework)
common_package(Collage 1.1  REQUIRED )
common_package(dash 1.0  REQUIRED )
common_package(Equalizer 1.8  REQUIRED )
common_package(Lunchbox 1.10  REQUIRED )
common_package(OpenGL   REQUIRED )
common_package(PNG   REQUIRED )
common_package(Qt5Core   REQUIRED )
common_package(Qt5OpenGL   REQUIRED )
common_package(Qt5Widgets   REQUIRED )
common_package(Threads   REQUIRED )

if(EXISTS ${PROJECT_SOURCE_DIR}/CMake/FindPackagesPost.cmake)
  include(${PROJECT_SOURCE_DIR}/CMake/FindPackagesPost.cmake)
endif()

if(BBPTESTDATA_FOUND)
  set(BBPTestData_name BBPTESTDATA)
  set(BBPTestData_FOUND TRUE)
elseif(BBPTestData_FOUND)
  set(BBPTestData_name BBPTestData)
  set(BBPTESTDATA_FOUND TRUE)
endif()
if(BBPTestData_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_BBPTESTDATA)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES BBPTestData)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} BBPTestData")
  link_directories(${${BBPTestData_name}_LIBRARY_DIRS})
  if(NOT "${${BBPTestData_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${BBPTestData_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${BBPTestData_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${BBPTestData_name}_INCLUDE_DIR})
  endif()
endif()

if(OPENMP_FOUND)
  set(OpenMP_name OPENMP)
  set(OpenMP_FOUND TRUE)
elseif(OpenMP_FOUND)
  set(OpenMP_name OpenMP)
  set(OPENMP_FOUND TRUE)
endif()
if(OpenMP_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_OPENMP)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES OpenMP)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} OpenMP")
  link_directories(${${OpenMP_name}_LIBRARY_DIRS})
  if(NOT "${${OpenMP_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${OpenMP_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${OpenMP_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${OpenMP_name}_INCLUDE_DIR})
  endif()
endif()

if(TUVOK_FOUND)
  set(Tuvok_name TUVOK)
  set(Tuvok_FOUND TRUE)
elseif(Tuvok_FOUND)
  set(Tuvok_name Tuvok)
  set(TUVOK_FOUND TRUE)
endif()
if(Tuvok_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_TUVOK)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES Tuvok)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} Tuvok")
  link_directories(${${Tuvok_name}_LIBRARY_DIRS})
  if(NOT "${${Tuvok_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${Tuvok_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${Tuvok_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${Tuvok_name}_INCLUDE_DIR})
  endif()
endif()

if(VTUNE_FOUND)
  set(VTune_name VTUNE)
  set(VTune_FOUND TRUE)
elseif(VTune_FOUND)
  set(VTune_name VTune)
  set(VTUNE_FOUND TRUE)
endif()
if(VTune_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_VTUNE)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES VTune)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} VTune")
  link_directories(${${VTune_name}_LIBRARY_DIRS})
  if(NOT "${${VTune_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${VTune_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${VTune_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${VTune_name}_INCLUDE_DIR})
  endif()
endif()

if(GLEW_MX_FOUND)
  set(GLEW_MX_name GLEW_MX)
  set(GLEW_MX_FOUND TRUE)
elseif(GLEW_MX_FOUND)
  set(GLEW_MX_name GLEW_MX)
  set(GLEW_MX_FOUND TRUE)
endif()
if(GLEW_MX_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_GLEW_MX)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES GLEW_MX)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} GLEW_MX")
  link_directories(${${GLEW_MX_name}_LIBRARY_DIRS})
  if(NOT "${${GLEW_MX_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${GLEW_MX_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${GLEW_MX_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${GLEW_MX_name}_INCLUDE_DIR})
  endif()
endif()

if(ZEQ_FOUND)
  set(zeq_name ZEQ)
  set(zeq_FOUND TRUE)
elseif(zeq_FOUND)
  set(zeq_name zeq)
  set(ZEQ_FOUND TRUE)
endif()
if(zeq_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_ZEQ)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES zeq)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} zeq")
  link_directories(${${zeq_name}_LIBRARY_DIRS})
  if(NOT "${${zeq_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${zeq_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${zeq_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${zeq_name}_INCLUDE_DIR})
  endif()
endif()

if(FLATBUFFERS_FOUND)
  set(FlatBuffers_name FLATBUFFERS)
  set(FlatBuffers_FOUND TRUE)
elseif(FlatBuffers_FOUND)
  set(FlatBuffers_name FlatBuffers)
  set(FLATBUFFERS_FOUND TRUE)
endif()
if(FlatBuffers_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_FLATBUFFERS)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES FlatBuffers)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} FlatBuffers")
  link_directories(${${FlatBuffers_name}_LIBRARY_DIRS})
  if(NOT "${${FlatBuffers_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(BEFORE SYSTEM ${${FlatBuffers_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${FlatBuffers_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(BEFORE SYSTEM ${${FlatBuffers_name}_INCLUDE_DIR})
  endif()
endif()

if(RESTBRIDGE_FOUND)
  set(RESTBridge_name RESTBRIDGE)
  set(RESTBridge_FOUND TRUE)
elseif(RESTBridge_FOUND)
  set(RESTBridge_name RESTBridge)
  set(RESTBRIDGE_FOUND TRUE)
endif()
if(RESTBridge_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_RESTBRIDGE)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES RESTBridge)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} RESTBridge")
  link_directories(${${RESTBridge_name}_LIBRARY_DIRS})
  if(NOT "${${RESTBridge_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${RESTBridge_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${RESTBridge_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${RESTBridge_name}_INCLUDE_DIR})
  endif()
endif()

if(LIBJPEGTURBO_FOUND)
  set(LibJpegTurbo_name LIBJPEGTURBO)
  set(LibJpegTurbo_FOUND TRUE)
elseif(LibJpegTurbo_FOUND)
  set(LibJpegTurbo_name LibJpegTurbo)
  set(LIBJPEGTURBO_FOUND TRUE)
endif()
if(LibJpegTurbo_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_LIBJPEGTURBO)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES LibJpegTurbo)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} LibJpegTurbo")
  link_directories(${${LibJpegTurbo_name}_LIBRARY_DIRS})
  if(NOT "${${LibJpegTurbo_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${LibJpegTurbo_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${LibJpegTurbo_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${LibJpegTurbo_name}_INCLUDE_DIR})
  endif()
endif()

if(BOOST_FOUND)
  set(Boost_name BOOST)
  set(Boost_FOUND TRUE)
elseif(Boost_FOUND)
  set(Boost_name Boost)
  set(BOOST_FOUND TRUE)
endif()
if(Boost_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_BOOST)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES Boost)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} Boost")
  link_directories(${${Boost_name}_LIBRARY_DIRS})
  if(NOT "${${Boost_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(SYSTEM ${${Boost_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${Boost_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(SYSTEM ${${Boost_name}_INCLUDE_DIR})
  endif()
endif()

if(COLLAGE_FOUND)
  set(Collage_name COLLAGE)
  set(Collage_FOUND TRUE)
elseif(Collage_FOUND)
  set(Collage_name Collage)
  set(COLLAGE_FOUND TRUE)
endif()
if(Collage_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_COLLAGE)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES Collage)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} Collage")
  link_directories(${${Collage_name}_LIBRARY_DIRS})
  if(NOT "${${Collage_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${Collage_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${Collage_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${Collage_name}_INCLUDE_DIR})
  endif()
endif()

if(DASH_FOUND)
  set(dash_name DASH)
  set(dash_FOUND TRUE)
elseif(dash_FOUND)
  set(dash_name dash)
  set(DASH_FOUND TRUE)
endif()
if(dash_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_DASH)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES dash)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} dash")
  link_directories(${${dash_name}_LIBRARY_DIRS})
  if(NOT "${${dash_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${dash_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${dash_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${dash_name}_INCLUDE_DIR})
  endif()
endif()

if(EQUALIZER_FOUND)
  set(Equalizer_name EQUALIZER)
  set(Equalizer_FOUND TRUE)
elseif(Equalizer_FOUND)
  set(Equalizer_name Equalizer)
  set(EQUALIZER_FOUND TRUE)
endif()
if(Equalizer_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_EQUALIZER)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES Equalizer)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} Equalizer")
  link_directories(${${Equalizer_name}_LIBRARY_DIRS})
  if(NOT "${${Equalizer_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${Equalizer_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${Equalizer_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${Equalizer_name}_INCLUDE_DIR})
  endif()
endif()

if(LUNCHBOX_FOUND)
  set(Lunchbox_name LUNCHBOX)
  set(Lunchbox_FOUND TRUE)
elseif(Lunchbox_FOUND)
  set(Lunchbox_name Lunchbox)
  set(LUNCHBOX_FOUND TRUE)
endif()
if(Lunchbox_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_LUNCHBOX)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES Lunchbox)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} Lunchbox")
  link_directories(${${Lunchbox_name}_LIBRARY_DIRS})
  if(NOT "${${Lunchbox_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${Lunchbox_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${Lunchbox_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${Lunchbox_name}_INCLUDE_DIR})
  endif()
endif()

if(OPENGL_FOUND)
  set(OpenGL_name OPENGL)
  set(OpenGL_FOUND TRUE)
elseif(OpenGL_FOUND)
  set(OpenGL_name OpenGL)
  set(OPENGL_FOUND TRUE)
endif()
if(OpenGL_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_OPENGL)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES OpenGL)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} OpenGL")
  link_directories(${${OpenGL_name}_LIBRARY_DIRS})
  if(NOT "${${OpenGL_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${OpenGL_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${OpenGL_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${OpenGL_name}_INCLUDE_DIR})
  endif()
endif()

if(PNG_FOUND)
  set(PNG_name PNG)
  set(PNG_FOUND TRUE)
elseif(PNG_FOUND)
  set(PNG_name PNG)
  set(PNG_FOUND TRUE)
endif()
if(PNG_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_PNG)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES PNG)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} PNG")
  link_directories(${${PNG_name}_LIBRARY_DIRS})
  if(NOT "${${PNG_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${PNG_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${PNG_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${PNG_name}_INCLUDE_DIR})
  endif()
endif()

if(QT5CORE_FOUND)
  set(Qt5Core_name QT5CORE)
  set(Qt5Core_FOUND TRUE)
elseif(Qt5Core_FOUND)
  set(Qt5Core_name Qt5Core)
  set(QT5CORE_FOUND TRUE)
endif()
if(Qt5Core_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_QT5CORE)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES Qt5Core)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} Qt5Core")
  link_directories(${${Qt5Core_name}_LIBRARY_DIRS})
  if(NOT "${${Qt5Core_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(BEFORE SYSTEM ${${Qt5Core_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${Qt5Core_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(BEFORE SYSTEM ${${Qt5Core_name}_INCLUDE_DIR})
  endif()
endif()

if(QT5OPENGL_FOUND)
  set(Qt5OpenGL_name QT5OPENGL)
  set(Qt5OpenGL_FOUND TRUE)
elseif(Qt5OpenGL_FOUND)
  set(Qt5OpenGL_name Qt5OpenGL)
  set(QT5OPENGL_FOUND TRUE)
endif()
if(Qt5OpenGL_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_QT5OPENGL)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES Qt5OpenGL)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} Qt5OpenGL")
  link_directories(${${Qt5OpenGL_name}_LIBRARY_DIRS})
  if(NOT "${${Qt5OpenGL_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${Qt5OpenGL_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${Qt5OpenGL_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${Qt5OpenGL_name}_INCLUDE_DIR})
  endif()
endif()

if(QT5WIDGETS_FOUND)
  set(Qt5Widgets_name QT5WIDGETS)
  set(Qt5Widgets_FOUND TRUE)
elseif(Qt5Widgets_FOUND)
  set(Qt5Widgets_name Qt5Widgets)
  set(QT5WIDGETS_FOUND TRUE)
endif()
if(Qt5Widgets_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_QT5WIDGETS)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES Qt5Widgets)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} Qt5Widgets")
  link_directories(${${Qt5Widgets_name}_LIBRARY_DIRS})
  if(NOT "${${Qt5Widgets_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${Qt5Widgets_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${Qt5Widgets_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${Qt5Widgets_name}_INCLUDE_DIR})
  endif()
endif()

if(THREADS_FOUND)
  set(Threads_name THREADS)
  set(Threads_FOUND TRUE)
elseif(Threads_FOUND)
  set(Threads_name Threads)
  set(THREADS_FOUND TRUE)
endif()
if(Threads_name)
  list(APPEND FIND_PACKAGES_DEFINES LIVRE_USE_THREADS)
  if(NOT COMMON_LIBRARY_TYPE MATCHES "SHARED")
    list(APPEND LIVRE_DEPENDENT_LIBRARIES Threads)
  endif()
  set(FIND_PACKAGES_FOUND "${FIND_PACKAGES_FOUND} Threads")
  link_directories(${${Threads_name}_LIBRARY_DIRS})
  if(NOT "${${Threads_name}_INCLUDE_DIRS}" MATCHES "-NOTFOUND")
    include_directories(${${Threads_name}_INCLUDE_DIRS})
  endif()
  if(NOT "${${Threads_name}_INCLUDE_DIR}" MATCHES "-NOTFOUND")
    include_directories(${${Threads_name}_INCLUDE_DIR})
  endif()
endif()

set(LIVRE_BUILD_DEBS autoconf;automake;avahi-daemon;bison;cmake;doxygen;flex;freeglut3-dev;git;git-review;libavahi-client-dev;libbluetooth-dev;libboost-date-time-dev;libboost-filesystem-dev;libboost-program-options-dev;libboost-regex-dev;libboost-serialization-dev;libboost-system-dev;libboost-test-dev;libboost-thread-dev;libgl1-mesa-dev;libglewmx1.6-dev;libhwloc-dev;libibverbs-dev;libjpeg-turbo8-dev;libleveldb-dev;libopencv-dev;libopenmpi-dev;libopenscenegraph-dev;libqt5opengl5-dev;librdmacm-dev;libspnav-dev;libturbojpeg;libudt-dev;libx11-dev;libzmq3-dev;openmpi-bin;pkg-config;qtbase5-dev;subversion)

set(LIVRE_DEPENDS BBPTestData;OpenMP;Tuvok;VTune;GLEW_MX;zeq;FlatBuffers;RESTBridge;LibJpegTurbo;Boost;Collage;dash;Equalizer;Lunchbox;OpenGL;PNG;Qt5Core;Qt5OpenGL;Qt5Widgets;Threads)

# Write defines.h and options.cmake
if(NOT PROJECT_INCLUDE_NAME)
  message(WARNING "PROJECT_INCLUDE_NAME not set, old or missing Common.cmake?")
  set(PROJECT_INCLUDE_NAME ${PROJECT_NAME})
endif()
if(NOT OPTIONS_CMAKE)
  set(OPTIONS_CMAKE ${CMAKE_CURRENT_BINARY_DIR}/options.cmake)
endif()
set(DEFINES_FILE "${CMAKE_CURRENT_BINARY_DIR}/include/${PROJECT_INCLUDE_NAME}/defines${SYSTEM}.h")
list(APPEND COMMON_INCLUDES ${DEFINES_FILE})
set(DEFINES_FILE_IN ${DEFINES_FILE}.in)
file(WRITE ${DEFINES_FILE_IN}
  "// generated by CMake/FindPackages.cmake, do not edit.\n\n"
  "#ifndef ${PROJECT_NAME}_DEFINES_${SYSTEM}_H\n"
  "#define ${PROJECT_NAME}_DEFINES_${SYSTEM}_H\n\n")
file(WRITE ${OPTIONS_CMAKE} "# Optional modules enabled during build\n")
foreach(DEF ${FIND_PACKAGES_DEFINES})
  add_definitions(-D${DEF}=1)
  file(APPEND ${DEFINES_FILE_IN}
  "#ifndef ${DEF}\n"
  "#  define ${DEF} 1\n"
  "#endif\n")
if(NOT DEF STREQUAL SYSTEM)
  file(APPEND ${OPTIONS_CMAKE} "set(${DEF} ON)\n")
endif()
endforeach()
if(CMAKE_MODULE_INSTALL_PATH)
  install(FILES ${OPTIONS_CMAKE} DESTINATION ${CMAKE_MODULE_INSTALL_PATH}
    COMPONENT dev)
else()
  message(WARNING "CMAKE_MODULE_INSTALL_PATH not set, old or missing Common.cmake?")
endif()
file(APPEND ${DEFINES_FILE_IN}
  "\n#endif\n")

include(UpdateFile)
configure_file(${DEFINES_FILE_IN} ${DEFINES_FILE} COPYONLY)
if(Boost_FOUND) # another WAR for broken boost stuff...
  set(Boost_VERSION ${Boost_MAJOR_VERSION}.${Boost_MINOR_VERSION}.${Boost_SUBMINOR_VERSION})
endif()
if(CUDA_FOUND)
  string(REPLACE "-std=c++11" "" CUDA_HOST_FLAGS "${CUDA_HOST_FLAGS}")
  string(REPLACE "-std=c++0x" "" CUDA_HOST_FLAGS "${CUDA_HOST_FLAGS}")
endif()
if(OPENMP_FOUND)
  set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${OpenMP_C_FLAGS}")
  set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${OpenMP_CXX_FLAGS}")
endif()
if(QT4_FOUND)
  if(WIN32)
    set(QT_USE_QTMAIN TRUE)
  endif()
  # Configure a copy of the 'UseQt4.cmake' system file.
  if(NOT EXISTS ${QT_USE_FILE})
    message(WARNING "Can't find QT_USE_FILE!")
  else()
    set(_customUseQt4File "${CMAKE_CURRENT_BINARY_DIR}/UseQt4.cmake")
    file(READ ${QT_USE_FILE} content)
    # Change all include_directories() to use the SYSTEM option
    string(REPLACE "include_directories(" "include_directories(SYSTEM " content ${content})
    string(REPLACE "INCLUDE_DIRECTORIES(" "INCLUDE_DIRECTORIES(SYSTEM " content ${content})
    file(WRITE ${_customUseQt4File} ${content})
    set(QT_USE_FILE ${_customUseQt4File})
    include(${QT_USE_FILE})
  endif()
endif()
if(FIND_PACKAGES_FOUND)
  if(MSVC)
    message(STATUS "Configured ${PROJECT_NAME} with ${FIND_PACKAGES_FOUND}")
  else()
    message(STATUS "Configured ${PROJECT_NAME} with ${CMAKE_BUILD_TYPE}${FIND_PACKAGES_FOUND}")
  endif()
endif()
